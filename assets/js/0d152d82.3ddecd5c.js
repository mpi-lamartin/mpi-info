"use strict";(self.webpackChunkmpi_info=self.webpackChunkmpi_info||[]).push([[5545],{6797:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>x,frontMatter:()=>c,metadata:()=>r,toc:()=>o});var i=s(4848),t=s(8453),a=s(6025);s(1122);const c={hide_table_of_contents:!0,hide_title:!1,cor:!0,title:"TP 9 : Apprentissage automatique"},l=void 0,r={id:"tp/tp_mnist/tp_mnist",title:"TP 9 : Apprentissage automatique",description:"Solution",source:"@site/docs/tp/9_tp_mnist/9_tp_mnist.mdx",sourceDirName:"tp/9_tp_mnist",slug:"/tp/tp_mnist/",permalink:"/mpi-info/docs/tp/tp_mnist/",draft:!1,unlisted:!1,editUrl:"https://github.com/mpi-lamartin/mpi-info/docs/tp/9_tp_mnist/9_tp_mnist.mdx",tags:[],version:"current",sidebarPosition:9,frontMatter:{hide_table_of_contents:!0,hide_title:!1,cor:!0,title:"TP 9 : Apprentissage automatique"},sidebar:"tp",previous:{title:"TP 8 : Probl\xe8me du bin packing",permalink:"/mpi-info/docs/tp/tp_binpacking/"},next:{title:"TP 10 : Jeu randomis\xe9 et route optimale (Centrale 2023)",permalink:"/mpi-info/docs/tp/tp_cs/"}},d={},o=[{value:"Fonctions utilitaires",id:"fonctions-utilitaires",level:2},{value:"KNN",id:"knn",level:2},{value:"k-moyennes",id:"k-moyennes",level:2}];function h(e){const n={a:"a",annotation:"annotation",br:"br",code:"code",h2:"h2",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(6177).A+"",children:(0,i.jsx)(n.strong,{children:"Solution"})})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["T\xe9l\xe9charger ",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(3585).A+"",children:"tp_apprentissage.zip"})," et le charger dans le Codespace avec clic droit -> charger."]}),"\n",(0,i.jsxs)(n.li,{children:["Le d\xe9compresser avec ",(0,i.jsx)(n.code,{children:"unzip tp_apprentissage.zip"})," dans le terminal."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"fonctions-utilitaires",children:"Fonctions utilitaires"}),"\n",(0,i.jsxs)(n.p,{children:["Dans cette partie, les fonctions seront \xe9crites dans ",(0,i.jsx)(n.code,{children:"utils.c"})," et d\xe9clar\xe9es dans ",(0,i.jsx)(n.code,{children:"utils.h"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Le dossier ",(0,i.jsx)(n.code,{children:"data"})," contient les donn\xe9es d'entra\xeenement et de test pour deux probl\xe8mes : classification de chiffres manuscrits (digits) et de v\xeatements (fashion).",(0,i.jsx)(n.br,{}),"\n","Pour chaque fichier :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"la premi\xe8re ligne est le nombre N de donn\xe9es"}),"\n",(0,i.jsxs)(n.li,{children:["chacune des N lignes suivantes contient ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mn,{children:"1"}),(0,i.jsx)(n.mo,{children:"+"}),(0,i.jsx)(n.mn,{children:"28"}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsx)(n.mn,{children:"28"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"1 + 28\\times 28"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord",children:"1"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"+"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord",children:"28"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(n.span,{className:"mord",children:"28"})]})]})]})," valeurs : le label de la donn\xe9e (0 \xe0 9 pour les chiffres et les v\xeatements) et les 28x28 pixels de l'image (de 0 \xe0 255)."]}),"\n"]}),"\n",(0,i.jsxs)("center",{children:[(0,i.jsx)("img",{src:(0,a.Ay)("/img/mnist.png"),height:400}),(0,i.jsx)("img",{src:(0,a.Ay)("/img/fashion.png"),height:400})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"utils.h"})," contient plusieurs d\xe9finitions, dont un type ",(0,i.jsx)(n.code,{children:"sample"})," permettant de repr\xe9senter une donn\xe9e :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"#define LEN (28 * 28) // taille d'une image\n#define NB_CLASSES 10\n\ntypedef struct data {\n    int class;\n    float pixels[LEN]; // pixels[i*28+j] est le pixel (i, j)\n} data;\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"utils.c"})," contient une fonction ",(0,i.jsx)(n.code,{children:"data* read_dataset(char* path, int n)"})," renvoyant un tableau contenant ",(0,i.jsx)(n.code,{children:"n"})," donn\xe9es du fichier ",(0,i.jsx)(n.code,{children:"path"}),"."]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"float d(data x1, data x2)"})," calculant la distance euclidienne au carr\xe9 entre deux donn\xe9es (il est inutile de calculer la racine carr\xe9e car on ne cherche qu'\xe0 comparer les distances)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"int nearest(data x, data* X, bool* T, int n)"})," renvoyant un ",(0,i.jsx)(n.code,{children:"i"})," tel que ",(0,i.jsx)(n.code,{children:"T[i]"})," est vrai et ",(0,i.jsx)(n.code,{children:"dist(x, X[i])"})," est minimum, o\xf9 ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"})," et de ",(0,i.jsx)(n.code,{children:"T"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"int majority(int* T, int n, int p)"})," renvoyant un \xe9l\xe9ment majoritaire d'un tableau ",(0,i.jsx)(n.code,{children:"T"})," de taille ",(0,i.jsx)(n.code,{children:"n"})," dont les \xe9l\xe9ments sont entre ",(0,i.jsx)(n.code,{children:"0"})," et ",(0,i.jsx)(n.code,{children:"p - 1"}),", en complexit\xe9 O(",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"n"}),(0,i.jsx)(n.mo,{children:"+"}),(0,i.jsx)(n.mi,{children:"p"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"n + p"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"+"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"p"})]})]})]}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"knn",children:"KNN"}),"\n",(0,i.jsxs)(n.p,{children:["Dans cette partie, les fonctions seront \xe9crites dans un nouveau fichier ",(0,i.jsx)(n.code,{children:"knn.c"}),"."]}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"int* k_nearest(data x, data* X, int n, int k)"})," renvoyant les indices des ",(0,i.jsx)(n.code,{children:"k"})," plus proches voisins de ",(0,i.jsx)(n.code,{children:"x"})," dans ",(0,i.jsx)(n.code,{children:"X"}),", o\xf9 ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"int knn(data x, data* X, int n, int k)"})," renvoyant la classe majoritaire des ",(0,i.jsx)(n.code,{children:"k"})," plus proches voisins de ",(0,i.jsx)(n.code,{children:"x"})," dans ",(0,i.jsx)(n.code,{children:"X"}),", o\xf9 ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Tester avec le code suivant, avec ",(0,i.jsx)(n.code,{children:"gcc -fsanitize=address -Wall knn.c utils.c && ./a.out"})," :"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:'int main() {\n    int n_train = 10000;\n    int n_test = 200;\n    int k = 3;\n    data *train = read_dataset("data/digit-train.txt", n_train);\n    printf("Read %d training data\\n", n_train);\n    data *test = read_dataset("data/digit-test.txt", n_test);\n    printf("Read %d testing data\\n", n_test);\n    int c = knn(test[0], train, n_train, k);\n    printf("Predicted class: %d (class is %d)\\n", c, test[0].class); // doit afficher 7\n    free(train);\n    free(test);\n    return 0;\n}\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"9",children:["\n",(0,i.jsxs)(n.li,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"precision(data* test, int n_test, data* train, int n_train, int k)"})," renvoyant la pr\xe9cision du classifieur KNN sur ",(0,i.jsx)(n.code,{children:"test"})," en utilisant ",(0,i.jsx)(n.code,{children:"train"})," pour l'entra\xeenement. Essayer avec diff\xe9rentes valeurs de ",(0,i.jsx)(n.code,{children:"k"}),", ",(0,i.jsx)(n.code,{children:"n_train"})," et ",(0,i.jsx)(n.code,{children:"n_test"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"k-moyennes",children:[(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"k"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]}),"-moyennes"]}),"\n",(0,i.jsxs)(n.p,{children:["Dans cette partie, les fonctions seront \xe9crites dans dans un nouveau fichier ",(0,i.jsx)(n.code,{children:"kmeans.c"}),"."]}),"\n",(0,i.jsxs)(n.ol,{start:"10",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"data* compute_centers(data* X, int n, int* classes, int k)"})," renvoyant les centres des classes obtenues par l'algorithme des ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"k"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]}),"-moyennes, o\xf9 ",(0,i.jsx)(n.code,{children:"classes[i]"})," est la classe de ",(0,i.jsx)(n.code,{children:"X[i]"}),", ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"})," et ",(0,i.jsx)(n.code,{children:"k"})," est la taille de classes."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"int* compute_classes(data* X, int n, data* centers, int k, bool* has_changed)"})," renvoyant les classes obtenues par l'algorithme des ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"k"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]}),"-moyennes, o\xf9 ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"})," et ",(0,i.jsx)(n.code,{children:"k"})," est la taille de ",(0,i.jsx)(n.code,{children:"centers"}),". ",(0,i.jsx)(n.code,{children:"has_changed"})," doit \xeatre mis \xe0 vrai si une donn\xe9e change de classe, faux sinon."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"data* init_centers(data* X, int n, int k)"})," renvoyant ",(0,i.jsx)(n.code,{children:"k"})," centres al\xe9atoires parmi les donn\xe9es de ",(0,i.jsx)(n.code,{children:"X"}),", o\xf9 ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"}),". On utilisera ",(0,i.jsx)(n.code,{children:"srand(time(NULL));"})," dans le ",(0,i.jsx)(n.code,{children:"main"})," et ",(0,i.jsx)(n.code,{children:"rand() % n"})," pour g\xe9n\xe9rer un nombre al\xe9atoire entre ",(0,i.jsx)(n.code,{children:"0"})," et ",(0,i.jsx)(n.code,{children:"n - 1"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\xc9crire une fonction ",(0,i.jsx)(n.code,{children:"int* kmeans(data* X, int n, int k)"})," renvoyant les classes obtenues par l'algorithme des ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"k"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]}),"-moyennes, o\xf9 ",(0,i.jsx)(n.code,{children:"n"})," est la taille de ",(0,i.jsx)(n.code,{children:"X"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Tester sur les donn\xe9es de chiffres."}),"\n"]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},3585:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/tp_apprentissage-41eee0a8bbf60a29108f43565cbfbce1.zip"},6177:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/tp_cor-d579f0246143d5a536c707e810eb3807.zip"},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var i=s(6540);const t={},a=i.createContext(t);function c(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);